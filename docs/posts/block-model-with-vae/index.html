<!DOCTYPE html>
<html lang="en">
<html class="dark light">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    

    
    
    
    <title>
         A stochastic block model and decades later
        
    </title>

        
            <meta property="og:title" content="A stochastic block model and decades later" />
        
     

     
         
     

     
         
    

    
    
        <link rel="icon" type="image/png" href=&#x2F;icon&#x2F;favicon.ico />
    

    
    
        <link href=https://ypark.github.io/fonts.css rel="stylesheet" />
    

    
    

    
    
        <script src=https://ypark.github.io/js/codeblock.js></script>
    

    
    
        <script src=https://ypark.github.io/js/toc.js></script>
    
    
    
    

    

	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
        
            <script>
            MathJax = {
              tex: {
                  inlineMath: [['$', '$'], ['\\(', '\\)'], ['$$', '$$']]
              }
            };
            </script>
        

	<!-- <\!-- KaTeX CSS -\-> -->
	<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.2/katex.min.css"> -->
	
	<!-- <\!-- KaTeX JS -\-> -->
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.2/katex.min.js"></script> -->
	
	<!-- <\!-- Optional: KaTeX Auto-render extension -\-> -->
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.2/contrib/auto-render.min.js"></script> -->
	
	<!-- <script> -->
	<!--   document.addEventListener("DOMContentLoaded", function() { -->
	<!--       renderMathInElement(document.body, { -->
	<!-- 	  delimiters: [ -->
	<!-- 	      {left: "$$", right: "$$", display: true}, -->
	<!-- 	      {left: "$", right: "$", display: false} -->
	<!-- 	  ] -->
	<!--       }); -->
	<!--   }); -->
	<!-- </script> -->

    

    
    <link rel="alternate" type="application/atom+xml" title="" href="https://ypark.github.io/atom.xml">


    
    
        <link rel="stylesheet" type="text/css" href=https://ypark.github.io/theme/light.css />
        <link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://ypark.github.io/theme/dark.css" />
    

    <!-- Set the correct theme in the script -->
    <script src=https://ypark.github.io/js/themetoggle.js></script>
    
        <script>setTheme(getSavedTheme());</script>
    

    <link rel="stylesheet" type="text/css" media="screen" href=https://ypark.github.io/main.css />

    
</head>


<body>
    <div class="content">
        <header>
    <div class="main">
        <a href=https:&#x2F;&#x2F;ypark.github.io></a>

        <div class="socials">
            
            <a rel="me" href="https:&#x2F;&#x2F;github.com&#x2F;causalpathlab&#x2F;" class="social">
                <img alt=github src=https://ypark.github.io/social_icons/github.svg>
            </a>
            
        </div>
    </div>

    <nav>
        
        <a href=https://ypark.github.io style="margin-left: 0.5em">home</a>
        
        <a href=https://ypark.github.io/about style="margin-left: 0.5em">&#x2F;about</a>
        
        <a href=https://ypark.github.io/posts style="margin-left: 0.5em">&#x2F;posts</a>
        
        <a href=https://ypark.github.io/team style="margin-left: 0.5em">&#x2F;team</a>
        
        <a href=https://ypark.github.io/alumni style="margin-left: 0.5em">&#x2F;alumni</a>
        

        
        |<a id="dark-mode-toggle" onclick="toggleTheme(); event.preventDefault();" href="#">
            <img src=https://ypark.github.io/feather/sun.svg id="sun-icon" style="filter: invert(1);" alt="Light" />
            <img src=https://ypark.github.io/feather/moon.svg id="moon-icon" alt="Dark" />
        </a>

        <!-- Inititialize the theme toggle icons -->
        <script>updateItemToggleTheme()</script>
        
    </nav>
</header>


        
        
    
<main>
  <article>
    <div class="title">
      
      
<div class="page-header">
  A stochastic block model and decades later<span class="primary-color" style="font-size: 1.6em">.</span>
</div>


      <div class="meta">
        
        Posted on <time>2025-03-30</time>
        

        

        

        
        
        <span class="tags-label"> :: Tags:</span>
        <span class="tags">
          <a href="https://ypark.github.io/tags/sbm/" class="post-tag">sbm</a>, 
          
          <a href="https://ypark.github.io/tags/block-model/" class="post-tag">block model</a>, 
          
          <a href="https://ypark.github.io/tags/graph/" class="post-tag">graph</a>, 
          
          <a href="https://ypark.github.io/tags/graph-neural-network/" class="post-tag">graph neural network</a>, 
          
          <a href="https://ypark.github.io/tags/neural-network/" class="post-tag">neural network</a>
          
        </span>
        

        
        
        
        
        
        

        
        

        

      </div>
    </div>

    

    
    
    
    <div class="toc-container">
      <h1 class="toc-title">Table of Contents</h1>
      <ul class="toc-list">
        
        <li>
          <a href="https://ypark.github.io/posts/block-model-with-vae/#generative-models">Generative models</a>
          
          <ul>
            
            <li>
              <a href="https://ypark.github.io/posts/block-model-with-vae/#discrete-non-mixed-stochastic-block-models">Discrete (non-mixed) stochastic block models</a>
            </li>

            
            
            <li>
              <a href="https://ypark.github.io/posts/block-model-with-vae/#mixed-membership-stochastic-block-models">Mixed-membership stochastic block models</a>
            </li>

            
            
          </ul>
          
        </li>
        
        <li>
          <a href="https://ypark.github.io/posts/block-model-with-vae/#let-s-put-a-stochastic-block-model-onto-a-vae-framework">Let&#x27;s put a stochastic block model onto a VAE framework</a>
          
        </li>
        
      </ul>
    </div>
    
    

    <section class="body">
      <h2 id="generative-models"><a class="zola-anchor" href="#generative-models" aria-label="Anchor link for: generative-models">Generative models</a></h2>
<h3 id="discrete-non-mixed-stochastic-block-models"><a class="zola-anchor" href="#discrete-non-mixed-stochastic-block-models" aria-label="Anchor link for: discrete-non-mixed-stochastic-block-models">Discrete (non-mixed) stochastic block models</a></h3>
<p>One of the most well-known examples in early social network study is this: <a href="https://www.jstor.org/stable/3629752">An Information Flow Model for Conflict and Fission in Small Groups</a> Zachary (1977).</p>
<blockquote>
<p>At the beginning of the study there was an incipient conflict
between the club president, John A., and Mr. Hi over the price of
karate lessons. Mr. Hi, who wished to raise prices, claimed the
authority to set his own lesson fees, since he was the
instructor. John A., who wished to stabilize prices, claimed the</p>
</blockquote>
<p>Letting information flow from the president (John A, or vertex <code>1</code>) to a new faction leader (Mr. Hi, or vertex <code>34</code>), the min-cut, max-flow algorithm results in two groups in the social network data:</p>
<p><img src="https://upload.wikimedia.org/wikipedia/en/thumb/8/87/Zachary_karate_club_social_network.png/330px-Zachary_karate_club_social_network.png" alt="Zachary&#39;s Karate Club" /></p>
<p>In classical stochastic block modelling, we assign a vertex (node) to a certain group or block (cluster). Each vertex may belong to only one of the blocks.</p>
<ul>
<li>
<p><a href="https://www.sciencedirect.com/science/article/abs/pii/0022249675900280">An algorithm for clustering relational data with applications to social network analysis and comparison with multidimensional scaling</a> (1975)</p>
</li>
<li>
<p><a href="https://dl.acm.org/doi/10.5555/1597538.1597600">Learning systems of concepts with an infinite relational model</a> (2006) or use <a href="https://cocosci.princeton.edu/tom/papers/irm.pdf">this link</a></p>
</li>
</ul>
<p>We can define a generative model for a binary relationship between vertices $i$ and $j$:</p>
<p>$$Y_{ij} | B \cdot \sim \prod_{k,l} B_{kl}^{z_{i}^{(k)} z_{j}^{(l)}}$$</p>
<p>where
$z_{i}^{(k)} = 1$ if and only if a vertex $i$ belongs to a cluster $k$; otherwise, $z_{i}^{(k)} = 0$. Here, $z_{i}^{k}$ can be modelled by <a href="https://en.wikipedia.org/wiki/Chinese_restaurant_process">Chinese Restaurant Process</a> <em>a priori</em> to accommodate an arbitrary number of groups/blocks/clusters.</p>
<h3 id="mixed-membership-stochastic-block-models"><a class="zola-anchor" href="#mixed-membership-stochastic-block-models" aria-label="Anchor link for: mixed-membership-stochastic-block-models">Mixed-membership stochastic block models</a></h3>
<p>Modelling all the group structures by a block matrix $B$ (Bernoulli or Poisson rate) is somewhat restrictive and would require unnecessarily many groups to model detailed structures. Instead of giving vertices discrete membership assignments, we can relax that their membership can be partial or more continuous in some latent space.</p>
<ul>
<li><a href="https://www.tandfonline.com/doi/abs/10.1198/016214502388618906">Latent Space Approaches to Social Network Analysis</a> (2002)</li>
</ul>
<p>$$p(Y) = \sigma\left( \beta_{0} + \sum_{a} \beta_{a} x_{ija} + \left. \sum_{k} z_{ik} z_{jk} \middle/ \sqrt{ \sum_{k} z_{jk}^{2} } \right. \right)$$</p>
<p>where $x_{ija}$ denotes an attribute variable for a pair $(i,j)$ and $\sigma(x)=1/(1+\exp(-x))$ for brevity and $z_{ik} \in \mathbb{R}$.</p>
<p>Similarly, we can give a partial membership of a vertex by assigning discrete membership of each vertex's incoming and outgoing interactions (edges/pairs adjacent to a vertex).</p>
<ul>
<li><a href="https://www.jmlr.org/papers/v9/airoldi08a.html">Mixed Membership Stochastic Blockmodels</a> (2008)</li>
</ul>
<p>$$p(Y_{ij} =1 |\cdot) = \sum_{k,l} z_{i\to{j}}^{(k)} B_{kl} z_{j\to{i}}^{(l)}$$</p>
<p>where we assign a discrete membership on the (directed) edges (all pairs). Here, each edge can belong to only one of the cluster, namely, $z_{i \to {j}}^{(k)} \in (0,1)$ and $\sum_{k} z_{i \to{j}}^{(k)} = 1$, but a vertex can be adjacent to multiple edge clusters without constraints.</p>
<ul>
<li><a href="https://papers.nips.cc/paper_files/paper/2009/hash/437d7d1d97917cd627a34a6a0fb41136-Abstract.html">Nonparametric Latent Feature Models for Link Prediction</a> (2009)</li>
</ul>
<p>We can relax the latent membership matrix $z_{ik}$ to allow mixed membership on nodes more explicitly:</p>
<p>$$p(Y_{ij} = 1 | \cdot) = \sigma\left( \sum_{k,l} z_{ik}^{\top} W_{kl} z_{jl} \right)$$</p>
<p>where $z_{ik} \in {0,1}$ without any row and column constraints.</p>
<ul>
<li><a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.84.036103">Efficient and principled method for detecting communities in networks</a> (2011)</li>
</ul>
<p>Another similar formulation can be found here with Poisson:</p>
<p>$$p(Y_{ij}| \cdot) = \frac{\left(\sum_{k} \theta_{ik} \theta_{jk}\right)^{Y_{ij}}}{Y_{ij}!} \exp\left( \sum_{k} \theta_{ik} \theta_{jk} \right),$$</p>
<p>where $\theta &gt; 0$. Here, we can partially introduce latent variables for edges</p>
<p>$$\log p(Y_{ij}| \cdot) \ge \sum_{k} \left[ Y_{ij} z_{ij}^{(k)} \log\frac{\theta_{ik}\theta_{jk}}{z_{ij}^{(k)}} - \theta_{ik} \theta_{jk} \right] - \log Y_{ij}$$
where the bound was derived by Jansen's inequality.</p>
<h2 id="let-s-put-a-stochastic-block-model-onto-a-vae-framework"><a class="zola-anchor" href="#let-s-put-a-stochastic-block-model-onto-a-vae-framework" aria-label="Anchor link for: let-s-put-a-stochastic-block-model-onto-a-vae-framework">Let's put a stochastic block model onto a VAE framework</a></h2>
<p><a href="https://proceedings.mlr.press/v97/mehta19a.html">Stochastic Blockmodels meet Graph Neural Networks</a> (2019)</p>
<blockquote>
<p>It is therefore desirable to have a model that retains the basic
spirit to
OSBM/<a href="https://papers.nips.cc/paper_files/paper/2009/hash/437d7d1d97917cd627a34a6a0fb41136-Abstract.html">LFRM</a>
(e.g., easy interpretability and strong link prediction
performance), but with greater expressiveness, and a simpler and
scalable inference procedure.</p>
</blockquote>
<p><img src="https://ypark.github.io/posts/block-model-with-vae/sbm_gnn.png" alt="" /></p>
<p>The decoder model (the left) is almost the same as the latent feature relational model:</p>
<p>$$p(A_{ij}| \cdot) = \sigma(f_{i}(z_{i})^{\top}f_{j}(z_{j}))$$
where $f_{i}$ is a neural network-like model for a vertex $i$ that maps a latent state $z_{i}$ to latent feature vectors.</p>
<p>I think the encoder part is more interesting:</p>
<ul>
<li>
<p>$q(v_{ik}) = \textsf{Beta}(c_{ik}, d_{ik})$</p>
</li>
<li>
<p>$q(b_{ik}) = \textsf{Bernoulli}(c_{ik}, d_{ik})$</p>
</li>
<li>
<p>$q(r_{i}) = \mathcal{N}(\mu_{i}, \textsf{diag}(\sigma_{i}^{2}))$</p>
</li>
</ul>
<p>All these "variational" parameters are modelled by a neural network model mapping a full adjacency matrix $A$ and a feature matrix $X$. We can make sampling steps differentiable by approximate reparameterization tricks.</p>
<!-- [A scalable gene network model of regulatory dynamics in single cells](https://arxiv.org/abs/2503.20027) (2023) -->

    </section>
  </article>
</main>



        

    </div>
</body>

</html>
